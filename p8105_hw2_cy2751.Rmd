---
title: "p8105_hw2_cy2751"
author: "Congyu Yang"
date: "2024-09-29"
output: github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(readxl)
```

## Problem 1

```{r}
NYCTransit_df <- read_csv(
  "datasets_hw2/NYC_Transit_Subway_Entrance_And_Exit_Data.csv",na = "",
  col_types = cols(Route8 = "c", Route9 = "c", Route10 = "c", Route11 = "c")) %>% 
  janitor::clean_names() %>% 
  select(line,station_name,station_latitude,station_longitude,(route1:route11),
         entry,exit_only,vending,entrance_type,ada) %>% 
  mutate(entry = ifelse(entry == "YES",T,F))
```
This dataset contains information of all train stations in NYC. Including variables train line, station name, the specific location of the station( latitude and longitude),all routes inside each station, entry and exit information, vending information, entrance type and whether ada compliance or not. I clean the data by importing data, identify `NA` values, specify the variable type of all routes. I also update variables names and select only the useful variables for the later question. Lastly, update variable `entry` to be a logical variable. Current dataset has dimension 1,868 Ã— 20.\
We cannot say these data are tidy, because when we need to focus on specific routes, routes should be a variable rather than a column name.\

```{r}
NYCTransit_df %>%  
  select(station_name, line) %>%  
  distinct() 
```
There are 465 distinct stations.

```{r}
NYCTransit_df %>% 
  select(station_name,line,ada) %>% 
  distinct() %>% 
  filter(ada == T) 
```
In all, 84 stations are ADA compliant.

```{r}
NYCTransit_df %>%
  filter(vending == "NO") %>% 
  pull(entry) %>% 
  mean()
```

Around 37.7% of station entrances/exit with vending allow entrance. 

```{r}
NYCTransit_df %>% 
  pivot_longer(
    cols = route1:route11,
    names_to = "route_number",
    values_to = "route_name",
    names_prefix = "route"
  ) %>% 
  filter(route_name == "A") %>% 
  select(line,station_name) %>% 
    distinct()

NYCTransit_df %>% 
  pivot_longer(
    cols = route1:route11,
    names_to = "route_number",
    values_to = "route_name",
    names_prefix = "route"
  ) %>% 
  filter(route_name == "A") %>% 
  select(line,station_name,ada) %>% 
  distinct() %>% 
    filter(ada == T)
  
```
60 distinct stations serve A train. Among these stations, 17 of them are ADA compliant.



## Problem 2

```{r}
Mr_Trash_df <- read_excel("datasets_hw2/202409 Trash Wheel Collection Data.xlsx",
                          sheet = "Mr. Trash Wheel",range = "A2:N653") %>% 
  janitor::clean_names() %>%
  mutate(sports_balls=as.integer(round(sports_balls))) %>% 
  mutate(year = as.numeric(year))

Professor_Trash_df <- read_excel("datasets_hw2/202409 Trash Wheel Collection Data.xlsx",
                          sheet = "Professor Trash Wheel",range = "A2:M120") %>% 
  janitor::clean_names()

Gwynnda_Trash_df <- read_excel("datasets_hw2/202409 Trash Wheel Collection Data.xlsx",
                          sheet = "Gwynnda Trash Wheel",range = "A2:L265") %>% 
  janitor::clean_names()

Mr_Trash_Bind <- Mr_Trash_df %>% mutate(name = "Mr_Trash") %>% 
  select(name,everything())

Professor_Trash_Bind <- Professor_Trash_df %>% mutate(name = "Professor_Trash") %>% 
  select(name,everything())

Gwynnda_Trash_Bind <- Gwynnda_Trash_df %>% mutate(name = "Gwynnda_Trash") %>% 
  select(name,everything())

(Whole_Trash_Bind <- bind_rows(Mr_Trash_Bind,Professor_Trash_Bind,Gwynnda_Trash_Bind) %>%
  select(-month,-year)) 
# remove month and year for tidy reason, date already includes such information
```
We combined three datasets: `Mr_Trash` dataset, `Professor_Trash` dataset and `Gwynnda_Trash` dataset. Each contains information about every dumpsters, including the date we collected data on, weight of trash it deals with in ton, volume of trash and amount of each kind of trash such as plastic bottles,polystyrene.... It is noteworthy that sports ball is a unique trash that only exists in `Mr_Trash` dataset and there is no glass bottle inside `Gwynnda_Trash` dataset. \
For `Mr_Trash` dataset, we collected information from `r nrow(Mr_Trash_df)` dumpsters;\
For `Professor_Trash` dataset, we collected information from `r nrow(Professor_Trash_df)` dumpsters;\

For `Gwynnda_Trash` dataset, we have information for 262 dumpsters, while we have `r nrow(Gwynnda_Trash_df)` pieces of information, it is because we have two rows for dumpster 21, but on the different date;\

The final dataset has `r nrow(Whole_Trash_Bind)` observations in total. For each observation, we have 13 variables. We removed `month` and `year` variable in the final dataset because these are redundant variables, we can also see these information in `date` variable. \
We added a new column `name` to the final dataset, which indicates which Trash Wheel does this dumpster come from. 

```{r}
Professor_Trash_df %>% select(weight_tons) %>% sum()
```
The total weight of trash collected by Professor Trash Wheel is `r Professor_Trash_df %>% select(weight_tons) %>% sum()` tons.\

```{r}
Gwynnda_Trash_df %>% 
  filter(month == "June", year == "2022") %>% 
  select(cigarette_butts) %>% 
  sum()
```
The total number of cigarette butts collected by Gwynnda in June of 2022 is 18120.\


